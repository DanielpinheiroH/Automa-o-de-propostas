### 1ï¸âƒ£ `requirements.txt`

```
tx
pandas
yagmail

```

---

### 2ï¸âƒ£ `config.json`

```json
{
"email_remetente": "[jonatas.tavares@metropoles.com](mailto:jonatas.tavares@metropoles.com)",
"senha_app": "cfovrmwsqyugxwvv",
"assunto_email": "Confira nossa proposta personalizada!",
"corpo_email": "OlÃ¡ {nome},\n\nSegue em anexo a nossa proposta especialmente preparada para vocÃª.\n\nAtenciosamente,\nCaio Bruno - MetrÃ³poles",
"segmento": ["bets","crypto","diversos","saÃºde"]
}

//criar os inputs para receber os valores que o json irÃ¡ consumir (o e-mail e senha poderÃ£o ser fixos, jÃ¡ o de assunto, corpo e segmento serÃ£o variÃ¡veis)
```

---

### 3ï¸âƒ£ `main.py` (com auto detecÃ§Ã£o de segmentos)

```python
python

import pandas as pd
import yagmail
import os
import json
from datetime import datetime

# ======= FunÃ§Ãµes utilitÃ¡rias =======

def criar_pasta_logs():
    if not os.path.exists('logs'):
        os.makedirs('logs')

def registrar_log(msg):
    data_str = datetime.now().strftime('%Y-%m-%d')
    log_path = f'logs/log_{data_str}.txt'
    with open(log_path, 'a', encoding='utf-8') as f:
        f.write(f"{datetime.now().strftime('%H:%M:%S')} - {msg}\n")

# ======= InÃ­cio =======

# Criar pasta de logs se nÃ£o existir
criar_pasta_logs()

# Carregar config
try:
    with open('config.json', 'r', encoding='utf-8') as f:
        config = json.load(f)
    registrar_log("âœ… ConfiguraÃ§Ã£o carregada com sucesso.")
except Exception as e:
    registrar_log(f"âŒ Erro ao carregar config.json: {e}")
    exit()

# ConfiguraÃ§Ã£o do yagmail
try:
    yag = yagmail.SMTP(user=config['email_remetente'], password=config['senha_app'])
    registrar_log("âœ… ConexÃ£o com servidor de e-mail estabelecida.")
except Exception as e:
    registrar_log(f"âŒ Erro na autenticaÃ§Ã£o do e-mail: {e}")
    exit()

# === Auto detectar segmentos ===
segmentos = []
for filename in os.listdir('contatos'):
    if filename.endswith('.csv'):
        segmento_nome = filename.replace('.csv', '')
        segmentos.append(segmento_nome)

registrar_log(f"ğŸ” Segmentos detectados: {segmentos}")

# Loop pelos segmentos detectados
for segmento in segmentos:
    registrar_log(f"\nğŸ”¹ Iniciando processamento do segmento: {segmento}")

    # Carregar contatos
    path_contatos = f'contatos/{segmento}.csv'
    try:
        df = pd.read_csv(path_contatos)
    except Exception as e:
        registrar_log(f"âŒ Erro ao ler CSV de contatos {segmento}: {e}")
        continue

    # Caminho da proposta
    path_proposta = f'propostas/{segmento}.pdf'
    if not os.path.exists(path_proposta):
        registrar_log(f"âš ï¸ Arquivo de proposta nÃ£o encontrado: {path_proposta}")
        continue

    # Enviar emails
    for index, row in df.iterrows():
        nome = row.get('Nome', '').strip()
        email = row.get('Email', '').strip()

        if not nome or not email:
            registrar_log(f"âš ï¸ Contato invÃ¡lido na linha {index+2}: Nome='{nome}', Email='{email}'")
            continue

        corpo_personalizado = config['corpo_email'].format(nome=nome)

        try:
            yag.send(
                to=email,
                subject=config['assunto_email'],
                contents=corpo_personalizado,
                attachments=path_proposta
            )
            registrar_log(f"âœ… E-mail enviado para {nome} <{email}>")
        except Exception as e:
            registrar_log(f"âŒ Erro ao enviar e-mail para {nome} <{email}>: {e}")

registrar_log("\nğŸš€ Processo concluÃ­do.")

```

---

### 4ï¸âƒ£ `executar.bat`

```
b
@echo off
cd /d %~dp0
python main.py
pause

```

---

### 5ï¸âƒ£ Exemplo de CSV para cada segmento (ex: `casa_de_apostas.csv`)

```
cs
Nome,Email
JoÃ£o Silva,joao@email.com
Maria Souza,maria@email.com

```

---

### Estrutura final esperada:

```
arduino

/automacao_envio_propostas/
â”‚
â”œâ”€â”€ contatos/
â”‚   â”œâ”€â”€ casa_de_apostas.csv
â”‚   â”œâ”€â”€ cripto.csv
â”‚   â”œâ”€â”€ esportes.csv
â”‚
â”œâ”€â”€ propostas/
â”‚   â”œâ”€â”€ casa_de_apostas.pdf
â”‚   â”œâ”€â”€ cripto.pdf
â”‚   â”œâ”€â”€ esportes.pdf
â”‚
â”œâ”€â”€ logs/                # serÃ¡ criada automaticamente
â”‚
â”œâ”€â”€ config.json
â”œâ”€â”€ main.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ executar.bat

```
